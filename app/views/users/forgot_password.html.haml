- title 'Retrieve Password'

= content_for :head do
  = stylesheet_link_tag :forgot_password
= render layout: 'layouts/partials/topper_stopper' do
  %h1.fade-on-submit
    Retrieve Password
  %br
  #errors
  %div
    - if @current_user
      %p.fade-on-submit
        You are currently logged in as&nbsp;
        %b> #{@current_user.username}
        \. If you know your password, you can change it in your #{link_to 'account settings', account_users_path}.
      %p.fade-on-submit If you have forgotten your password, you can reset it:
      / Replaced: button_to with remote: true → button_to without (Turbo intercepts form submission automatically)
      = button_to('Reset Password', send_password_reset_users_path, class: 'button alert fade-on-submit', data: { disable_with: 'Resetting...' })
    -else
      / Replaced: form_tag with remote: true → form_with (Turbo handles AJAX submission)
      = form_with(url: send_password_reset_users_path, method: :post, html: { class: 'fade-on-submit' }) do |f|
        %h5 Please enter your username or email address
        %hr
        = label_tag :username
        = text_field_tag :username
        %h4 OR
        = label_tag :email
        = email_field_tag :email
        = submit_tag 'Send', class: 'button alert', data: {disable_with: 'Resetting...'}
    / id="email-sent" targeted by send_password_reset.turbo_stream.erb to reveal confirmation message
    %h#email-sent.hidden
      You should receive an email shortly with a link to reset your password.
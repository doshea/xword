// =============================================================================
// Components — xw- prefix
// =============================================================================
// Reusable UI components built on the design token system.
// These replace Foundation's component classes during Phases 1-5.
// Foundation is removed in Phase 6.
// =============================================================================

@import 'design_tokens';


// ---------------------------------------------------------------------------
// BUTTONS — .xw-btn
// ---------------------------------------------------------------------------
// Usage:  .xw-btn                     (default: primary/accent)
//         .xw-btn.xw-btn--secondary   (outlined, muted)
//         .xw-btn.xw-btn--ghost       (text-only, transparent bg)
//         .xw-btn.xw-btn--danger      (destructive action)
//         .xw-btn.xw-btn--success     (confirm/save)
//         .xw-btn.xw-btn--sm          (compact)
//         .xw-btn.xw-btn--lg          (prominent CTA)
//         .xw-btn.xw-btn--full        (full width)
// ---------------------------------------------------------------------------

.xw-btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: var(--space-2);
  padding: var(--space-2) var(--space-4);
  border: 1px solid transparent;
  border-radius: var(--radius-md);
  font-family: var(--font-ui);
  font-size: var(--text-sm);
  font-weight: var(--weight-medium);
  line-height: var(--leading-tight);
  text-decoration: none;
  cursor: pointer;
  transition: var(--transition-colors), var(--transition-shadow);
  white-space: nowrap;
  user-select: none;

  // Default: accent (forest green)
  background-color: var(--color-accent);
  color: #fff;
  border-color: var(--color-accent);

  &:hover, &:focus-visible {
    background-color: var(--color-accent-hover);
    border-color: var(--color-accent-hover);
    box-shadow: var(--shadow-md);
    outline: none;
  }

  &:active { transform: translateY(1px); }
  &:disabled, &[disabled] {
    opacity: 0.5;
    cursor: not-allowed;
    pointer-events: none;
  }

  // Sizes
  &.xw-btn--sm {
    padding: var(--space-1) var(--space-3);
    font-size: var(--text-xs);
    border-radius: var(--radius-sm);
  }
  &.xw-btn--lg {
    padding: var(--space-3) var(--space-6);
    font-size: var(--text-base);
  }
  &.xw-btn--full { width: 100%; }

  // Variants
  &.xw-btn--secondary {
    background-color: transparent;
    color: var(--color-text-secondary);
    border-color: var(--color-border-strong);
    &:hover, &:focus-visible {
      background-color: var(--color-surface-alt);
      border-color: var(--color-border-strong);
      color: var(--color-text);
    }
  }

  &.xw-btn--ghost {
    background-color: transparent;
    border-color: transparent;
    color: var(--color-accent);
    &:hover, &:focus-visible {
      background-color: var(--color-accent-light);
      border-color: transparent;
      box-shadow: none;
    }
  }

  &.xw-btn--danger {
    background-color: var(--color-danger);
    border-color: var(--color-danger);
    color: #fff;
    &:hover, &:focus-visible {
      background-color: var(--color-danger-text);
      border-color: var(--color-danger-text);
    }
  }

  &.xw-btn--success {
    background-color: var(--color-success);
    border-color: var(--color-success);
    color: #fff;
    &:hover, &:focus-visible {
      background-color: var(--color-success-text);
      border-color: var(--color-success-text);
    }
  }

  &.xw-btn--warning {
    background-color: var(--color-warning);
    border-color: var(--color-warning);
    color: #fff;
    &:hover, &:focus-visible {
      background-color: var(--color-warning-text);
      border-color: var(--color-warning-text);
    }
  }

  svg { flex-shrink: 0; }
}


// ---------------------------------------------------------------------------
// ALERTS — .xw-alert
// ---------------------------------------------------------------------------
// Left-border accent style — more editorial than Foundation's boxy alerts.
// Dismissible via alert Stimulus controller (Phase 4e).
//
// Usage:  .xw-alert.xw-alert--success / --warning / --error / --info
// ---------------------------------------------------------------------------

.xw-alert {
  display: flex;
  align-items: flex-start;
  gap: var(--space-3);
  padding: var(--space-3) var(--space-4);
  border-left: 3px solid currentColor;
  border-radius: 0 var(--radius-md) var(--radius-md) 0;
  font-family: var(--font-ui);
  font-size: var(--text-sm);
  position: relative;

  &.xw-alert--info {
    background-color: var(--color-info-bg);
    color: var(--color-info-text);
  }
  &.xw-alert--success {
    background-color: var(--color-success-bg);
    color: var(--color-success-text);
  }
  &.xw-alert--warning {
    background-color: var(--color-warning-bg);
    color: var(--color-warning-text);
  }
  &.xw-alert--error {
    background-color: var(--color-danger-bg);
    color: var(--color-danger-text);
  }

  // Dismiss button (×) — placed by alert Stimulus controller
  .xw-alert__dismiss {
    position: absolute;
    top: var(--space-2);
    right: var(--space-3);
    background: none;
    border: none;
    cursor: pointer;
    opacity: 0.5;
    font-size: var(--text-lg);
    line-height: 1;
    padding: 0;
    color: inherit;
    &:hover { opacity: 1; }
  }
}


// ---------------------------------------------------------------------------
// CARDS — .xw-card
// ---------------------------------------------------------------------------

.xw-card {
  background-color: var(--color-surface);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow-sm);
  overflow: hidden;
  transition: var(--transition-shadow), transform var(--duration-base) var(--ease-out);

  &:hover {
    box-shadow: var(--shadow-md);
    transform: translateY(-1px);
  }

  .xw-card__body {
    padding: var(--space-4);
  }

  .xw-card__header {
    padding: var(--space-3) var(--space-4);
    border-bottom: 1px solid var(--color-border);
    font-family: var(--font-ui);
    font-size: var(--text-sm);
    font-weight: var(--weight-semibold);
    color: var(--color-text-secondary);
    text-transform: uppercase;
    letter-spacing: var(--tracking-wider);
  }
}

// Puzzle card — used by _crossword_tab.html.haml (Phase 3c)
.xw-puzzle-card {
  @extend .xw-card;
  display: block;
  text-decoration: none;
  color: var(--color-text);

  .xw-puzzle-card__thumb {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: var(--space-3);
    background-color: var(--color-surface-alt);

    img {
      display: block;
      max-height: 6rem;
      width: auto;
    }
  }

  .xw-puzzle-card__meta {
    padding: var(--space-3) var(--space-4) var(--space-4);

    .xw-puzzle-card__title {
      font-family: var(--font-display);
      font-size: var(--text-base);
      font-weight: var(--weight-bold);
      line-height: var(--leading-tight);
      margin-bottom: var(--space-1);
    }

    .xw-puzzle-card__byline {
      font-family: var(--font-ui);
      font-size: var(--text-xs);
      color: var(--color-text-muted);
    }

    .xw-puzzle-card__dims {
      font-family: var(--font-ui);
      font-size: var(--text-xs);
      color: var(--color-text-muted);
      margin-top: var(--space-1);
    }
  }
}


// ---------------------------------------------------------------------------
// TOOLTIPS — [data-xw-tooltip] — pure CSS, no JS
// ---------------------------------------------------------------------------
// Usage: %button{ data: { 'xw-tooltip': 'Save puzzle' } }

[data-xw-tooltip] {
  position: relative;

  &::after {
    content: attr(data-xw-tooltip);
    position: absolute;
    bottom: calc(100% + var(--space-1));
    left: 50%;
    transform: translateX(-50%);
    background-color: var(--color-nav-bg);
    color: var(--color-nav-text);
    font-family: var(--font-ui);
    font-size: var(--text-xs);
    white-space: nowrap;
    padding: var(--space-1) var(--space-2);
    border-radius: var(--radius-sm);
    pointer-events: none;
    opacity: 0;
    transition: opacity var(--duration-fast) var(--ease-out);
    z-index: var(--z-dropdown);
  }

  &:hover::after, &:focus-visible::after {
    opacity: 1;
  }
}


// ---------------------------------------------------------------------------
// MODALS — .xw-modal (native <dialog> element)
// ---------------------------------------------------------------------------
// Opened via modal Stimulus controller (Phase 4a): dialog.showModal()
// Closed via dialog.close() or clicking the backdrop.

.xw-modal {
  border: none;
  border-radius: var(--radius-xl);
  box-shadow: var(--shadow-xl);
  padding: var(--space-8);
  max-width: 36rem;   // SassC (LibSass) can't evaluate CSS min() — use two-property equivalent
  width: 90vw;
  width: 100%;
  background-color: var(--color-surface);
  color: var(--color-text);

  &::backdrop {
    background-color: rgba(28, 26, 23, 0.6);
    backdrop-filter: blur(2px);
  }

  .xw-modal__header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: var(--space-6);

    h2, h3 {
      font-family: var(--font-display);
      margin: 0;
    }
  }

  .xw-modal__close {
    background: none;
    border: none;
    cursor: pointer;
    font-size: var(--text-xl);
    line-height: 1;
    opacity: 0.5;
    padding: 0;
    color: var(--color-text);
    &:hover { opacity: 1; }
  }
}


// ---------------------------------------------------------------------------
// TABS — .xw-tabs / .xw-tab-panels
// ---------------------------------------------------------------------------
// Animated by tabs Stimulus controller (Phase 4b).
// Usage:
//   .xw-tabs{ data: { controller: 'tabs' } }
//     .xw-tabs__nav
//       %button.xw-tab{ data: { action: 'tabs#select', tabs_target: 'tab' }, class: 'xw-tab--active' } Across
//       %button.xw-tab{ data: { action: 'tabs#select', tabs_target: 'tab' } } Down
//     .xw-tab-panels
//       .xw-tab-panel{ data: { tabs_target: 'panel' } } ...
//       .xw-tab-panel{ data: { tabs_target: 'panel' } } ...

.xw-tabs {
  .xw-tabs__nav {
    display: flex;
    gap: var(--space-1);
    border-bottom: 2px solid var(--color-border);
    margin-bottom: var(--space-4);
  }

  &.xw-tabs--vertical {
    display: flex;
    gap: var(--space-6);

    .xw-tabs__nav {
      flex-direction: column;
      border-bottom: none;
      border-right: 2px solid var(--color-border);
      padding-right: var(--space-4);
      margin-bottom: 0;
      min-width: 10rem;
    }
  }
}

.xw-tab {
  background: none;
  border: none;
  border-bottom: 2px solid transparent;
  margin-bottom: -2px;
  padding: var(--space-2) var(--space-4);
  font-family: var(--font-ui);
  font-size: var(--text-sm);
  font-weight: var(--weight-medium);
  color: var(--color-text-muted);
  cursor: pointer;
  transition: var(--transition-colors);
  white-space: nowrap;

  &:hover { color: var(--color-text); }

  &.xw-tab--active {
    color: var(--color-accent);
    border-bottom-color: var(--color-accent);
  }

  // Vertical orientation
  .xw-tabs--vertical & {
    border-bottom: none;
    border-right: 2px solid transparent;
    margin-bottom: 0;
    margin-right: -2px;
    text-align: left;
    border-radius: var(--radius-sm) 0 0 var(--radius-sm);

    &.xw-tab--active {
      border-right-color: var(--color-accent);
      background-color: var(--color-accent-light);
    }
  }
}

.xw-tab-panels { flex: 1; min-width: 0; }

.xw-tab-panel {
  display: none;
  &.xw-tab-panel--active { display: block; }
}


// ---------------------------------------------------------------------------
// FORMS — inputs, labels, fieldsets
// ---------------------------------------------------------------------------

.xw-field {
  display: flex;
  flex-direction: column;
  gap: var(--space-1);
  margin-bottom: var(--space-4);
}

.xw-label {
  font-family: var(--font-ui);
  font-size: var(--text-sm);
  font-weight: var(--weight-medium);
  color: var(--color-text-secondary);
}

.xw-input,
.xw-textarea,
.xw-select {
  width: 100%;
  padding: var(--space-2) var(--space-3);
  background-color: var(--color-surface);
  border: 1px solid var(--color-border-strong);
  border-radius: var(--radius-md);
  font-family: var(--font-body);
  font-size: var(--text-base);
  color: var(--color-text);
  transition: border-color var(--duration-base) var(--ease-in-out),
              box-shadow var(--duration-base) var(--ease-out);
  appearance: none;

  &::placeholder { color: var(--color-text-muted); }

  &:focus {
    outline: none;
    border-color: var(--color-accent);
    box-shadow: 0 0 0 3px var(--color-accent-light);
  }

  &:disabled {
    background-color: var(--color-surface-sunken);
    opacity: 0.6;
    cursor: not-allowed;
  }
}

.xw-textarea { resize: vertical; min-height: 6rem; line-height: var(--leading-relaxed); }

// Error state
.xw-input--error,
.xw-textarea--error {
  border-color: var(--color-danger);
  &:focus { box-shadow: 0 0 0 3px var(--color-danger-bg); }
}

.xw-field-error {
  font-family: var(--font-ui);
  font-size: var(--text-xs);
  color: var(--color-danger-text);
}


// ---------------------------------------------------------------------------
// BADGES / TAGS
// ---------------------------------------------------------------------------

.xw-badge {
  display: inline-flex;
  align-items: center;
  padding: 0 var(--space-2);
  height: 1.25rem;
  border-radius: var(--radius-full);
  font-family: var(--font-ui);
  font-size: var(--text-xs);
  font-weight: var(--weight-semibold);
  background-color: var(--color-surface-alt);
  color: var(--color-text-secondary);

  &.xw-badge--accent   { background-color: var(--color-accent-light); color: var(--color-accent); }
  &.xw-badge--success  { background-color: var(--color-success-bg);   color: var(--color-success-text); }
  &.xw-badge--warning  { background-color: var(--color-warning-bg);   color: var(--color-warning-text); }
  &.xw-badge--danger   { background-color: var(--color-danger-bg);    color: var(--color-danger-text); }
}


// ---------------------------------------------------------------------------
// SECTION WRAPPER — replaces .row-bookend / .row-topper / .row-stopper
// ---------------------------------------------------------------------------
// Used in Phase 5 when black bar pattern is replaced.

.xw-section {
  background-color: var(--color-surface);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow-sm);
  margin-bottom: var(--space-4);

  &.xw-section--dark {
    background-color: var(--color-nav-bg);
    border-color: var(--color-nav-border);
    color: var(--color-text-inverse);
  }
}
